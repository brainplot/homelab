- name: Set up ansible host
  hosts: all
  roles: [ansible]

- name: Set up common things
  hosts: all
  roles:
    - admin
    - ntp
    - vim
    - editor
    - locale

- name: Disable wifi and bluetooth
  hosts: rpi
  become: true
  tasks:
    - name: Disable wifi
      ansible.builtin.lineinfile:
        path: /boot/config.txt
        line: dtoverlay=disable-wifi
        insertafter: '# /boot/firmware/overlays/README'
      notify: Reboot

    - name: Disable bluetooth
      ansible.builtin.lineinfile:
        path: /boot/config.txt
        line: dtoverlay=disable-bt
        insertafter: dtoverlay=disable-wifi
      notify: Reboot
  handlers:
    - name: Reboot
      become: true
      ansible.builtin.reboot: ~
